Package: node-tar
Version: 6.0.5
Revision: 1.1
###
BuildDepends: <<
	fink (>= 0.32)
<<
Depends: <<
	node-chownr,
	node-mkdirp (>= 1),
	node-safe-buffer,
	node-yallist (>= 3.0.3-2),
	nodejs
<<
###
Source: mirror:debian:/pool/main/n/%n/%n_%v+ds1+~cs11.3.9.orig.tar.gz
Source-Checksum: SHA256(042ca18da6d5dfc2c41aa0169abac8ae70497fb5b340c8fe5b71aa47705606d9)
SourceDirectory: %n-%v
Source2: mirror:debian:pool/main/n/%n/%n_%v+ds1+~cs11.3.9-1+deb11u2.debian.tar.xz
Source2-Checksum: SHA256(9c7f680ad11f0162426f28fd194d099da73afda2b5925aa8ca8fc37326811113)
Source2ExtractDir: %n-%v
Source3: mirror:debian:pool/main/n/%n/%n_%v+ds1+~cs11.3.9.orig-fs-minipass.tar.gz
Source3-Checksum: SHA256(83cf7dc113dacdbe3a2d05753edde01c37256cc97167ea5a8086ab85a78f2efd)
Source3ExtractDir: %n-%v
Source4: mirror:debian:pool/main/n/%n/%n_%v+ds1+~cs11.3.9.orig-minipass.tar.gz
Source4-Checksum: SHA256(496598d78b824ddb3116c4a4fe0123516b318eab820d0ee80cb892ef3ba0c4c9)
Source4ExtractDir: %n-%v
Source5: mirror:debian:pool/main/n/%n/%n_%v+ds1+~cs11.3.9.orig-minizlib.tar.gz
Source5-Checksum: SHA256(296f5e559312e7a4dd871e1cdad27d50d9d0518a548ae870dffb678ff2ecae7e)
Source5ExtractDir: %n-%v
Source6: mirror:debian:pool/main/n/%n/%n_%v+ds1+~cs11.3.9.orig-types-tar.tar.gz
Source6-Checksum: SHA256(e59a412960136fd1b0a303a7284d849eec4de7658627083058c9caf1ebb28d03)
Source6ExtractDir: %n-%v
###
DocFiles: README.md LICENSE CHANGELOG.md
###
PatchScript: <<
mv fs-minipass-2.1.0 fs-minipass
mv minipass-3.1.3 minipass
mv minizlib-2.1.2 minizlib
mv tar types

patch -p1 < debian/patches/api-backward-compatibility.patch
patch -p1 < debian/patches/disable-failing-tests.diff
patch -p1 < debian/patches/CVE-2021-32803.patch
patch -p1 < debian/patches/CVE-2021-32804.patch
patch -p1 < debian/patches/CVE-2021-37701.patch
patch -p1 < debian/patches/CVE-2021-37712.patch
patch -p1 < debian/patches/add-noChmod-option.patch
<<
CompileScript: <<
mkdir -p node_modules/fs-minipass
cp fs-minipass/index.js node_modules/fs-minipass/
cp fs-minipass/package.json node_modules/fs-minipass/

mkdir -p node_modules/minipass
cp minipass/index.js node_modules/minipass/
cp minipass/package.json node_modules/minipass/

mkdir -p node_modules/minizlib
cp minizlib/constants.js node_modules/minizlib/
cp minizlib/index.js node_modules/minizlib/
cp minizlib/package.json node_modules/minizlib/
<<
InfoTest: <<
	TestDepends: <<
		node-end-of-stream,
		node-mutate-fs,
		node-rimraf,
		node-tap,
		node-tar-stream
	<<
	TestScript: <<
TAP_TIMEOUT=60 \
NODE_PATH=%b/debian/tests/test_modules:%b/node_modules \
tap test || exit 2
	<<
<<
InstallScript: <<
install -d -m0755 %i/share/nodejs/tar
install -m0644 index.js %i/share/nodejs/tar/
install -m0644 package.json %i/share/nodejs/tar/
cp -R lib %i/share/nodejs/tar/
cp -R node_modules %i/share/nodejs/tar/

install -d -m0755 %i/share/nodejs/@types/tar
install -m0644 types/index.d.ts %i/share/nodejs/@types/tar/
install -m0644 types/package.json %i/share/nodejs/@types/tar/
<<
###
Description: Read and write portable tar archives
DescDetail: <<
node-tar is able to read and write tar archives generated by
bsdtar, gnutar, solaris posix tar, and "Schilly" tar.
node-tar is a well-tested essential piece of software for npm,
the Node.js package manager.
.
This package includes components: chownr, minipass, fs-minipass,
minizlib.
.
Node.js is an event-based server-side javascript engine.
<<
###
License: BSD
Homepage: https://github.com/npm/node-tar
Maintainer: Justin F. Hallett <thesin@users.sourceforge.net>
